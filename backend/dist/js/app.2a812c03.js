(function(t){function e(e){for(var a,n,s=e[0],l=e[1],c=e[2],u=0,p=[];u<s.length;u++)n=s[u],r[n]&&p.push(r[n][0]),r[n]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);d&&d(e);while(p.length)p.shift()();return i.push.apply(i,c||[]),o()}function o(){for(var t,e=0;e<i.length;e++){for(var o=i[e],a=!0,s=1;s<o.length;s++){var l=o[s];0!==r[l]&&(a=!1)}a&&(i.splice(e--,1),t=n(n.s=o[0]))}return t}var a={},r={app:0},i=[];function n(e){if(a[e])return a[e].exports;var o=a[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=a,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(o,a,function(e){return t[e]}.bind(null,a));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var d=l;i.push([0,"chunk-vendors"]),o()})({0:function(t,e,o){t.exports=o("56d7")},"034f":function(t,e,o){"use strict";var a=o("64a9"),r=o.n(a);r.a},"16e2":function(t,e,o){"use strict";var a=o("ae3f"),r=o.n(a);r.a},"56d7":function(t,e,o){"use strict";o.r(e);o("cadf"),o("551c"),o("f751"),o("097d");var a=o("2b0e"),r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"app"}},[null===t.jwtToken?o("div",[o("LoginComponent",{on:{loginSuccess:t.handleLogin}})],1):o("div",[null!==t.jwtToken?o("GameStage",{attrs:{"jwt-token":t.jwtToken}}):t._e(),null!==t.jwtToken?o("UserInfo",{attrs:{"jwt-token":t.jwtToken}}):t._e(),null!==t.jwtToken?o("Betting",{attrs:{"jwt-token":t.jwtToken}}):t._e(),null!==t.jwtToken?o("GameInfo",{attrs:{"jwt-token":t.jwtToken}}):t._e()],1)])},i=[],n=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},s=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{attrs:{id:"game_body"}})])}],l=(o("55dd"),o("e814")),c=o.n(l),d=o("bc3a"),u=o.n(d),p=o("912c"),h=null,f={fullView:null},w={horses:[],track:null,concrete:null,steel_fender:null,grass_fender:null,seat:null,seat_exit:null,seat_stair:null,road_decoration:null,track_floor:null,sign:null,audiences:[],waitingHorses:[]},m=function(){};function g(t,e){return Math.floor(Math.random()*(e-t+1))+t}var _={name:"GameStage",props:{jwtToken:String},data:function(){return{engineIntv:5e3,highIntv:1e3,lowIntv:5e3,loaderEngine:null,distances:[],track_win:[],hasWinner:!1}},methods:{loader:function(){var t=this;u.a.get(this.gameServer+"/racetracks",{headers:{Authorization:this.jwtToken}}).then(function(e){var o=JSON.parse(e.data);if(c()(o.isGaming&&t.engineIntv===t.lowIntv)){for(var a=0;a<w.waitingHorses.length;a++)f.fullView.removeChild(w.waitingHorses[a]),f.fullView.addChild(w.horses[a]);m=t.runState,t.track_win=[],t.hasWinner=!1,clearInterval(t.loaderEngine),t.engineIntv=t.highIntv,t.loaderEngine=setInterval(t.loader,t.engineIntv)}else if(!c()(o.isGaming)&&t.engineIntv===t.highIntv){for(var r=0;r<o.track_win.length;r++)t.track_win.push(o.track_win[r]);t.hasWinner=!0;for(var i=0;i<w.horses[i].length;i++)w.waitingHorses[i].x=w.horses[i].x,f.fullView.removeChild(w.horses[i]),f.fullView.addChild(w.waitingHorses[i]);m=t.endingState,clearInterval(t.loaderEngine),t.engineIntv=t.lowIntv,t.loaderEngine=setInterval(t.loader,t.engineIntv)}for(var n=0;n<o.distances.length;n++)t.distances[n]=c()(o.distances[n])})},cameraScroll:function(){for(var t=[],e=0;e<w.horses.length;e++)t.push(w.horses[e].x);t.sort(function(t,e){return e-t});var o=t[0];o>=window.innerWidth-150-f.fullView.x&&(f.fullView.x-=o-(window.innerWidth-150-f.fullView.x))},horseRunRandomlyState:function(){for(var t=0;t<w.horses.length;t++){var e=g(1,2),o=g(1,2)/10;1===e?(w.horses[t].vx+=o,w.horses[t].x+=w.horses[t].vx):w.horses[t].vx-o>=0&&(w.horses[t].vx-=o,w.horses[t].x+=w.horses[t].vx)}this.cameraScroll(),f.fullView.x<=-2350+window.innerWidth&&(m=this.endingState)},runState:function(){for(var t=0;t<w.horses.length;t++)w.horses[t].x=this.distances[t]*(window.innerWidth+150)/100;this.cameraScroll()},endingState:function(){var t=this;setTimeout(function(){for(var e=8,o=20,a=0;a<w.waitingHorses.length;a++)w.waitingHorses[a].x=o+e*w.waitingHorses.length-e*(a-1);m=t.waitingState},1e4)},waitingState:function(){},gameLoop:function(t){m(t)},gameLoadSetup:function(){var t=this,e=p["loader"].resources["images/fastma_spritesheet.json"].spritesheet;f.fullView=new p["Container"];for(var o=0;o<8;o++)for(var a=0;a<=40;a++)w.concrete=new p["Sprite"](e.textures["concrete.png"]),w.concrete.x=w.concrete.width*a-o%2*30,w.concrete.y=15*o-15-o,f.fullView.addChild(w.concrete);for(var r=0;r<=20;r++)w.steel_fender=new p["Sprite"](e.textures["steel_fender_1.png"]),w.steel_fender.y=30,w.steel_fender.x=w.steel_fender.width*r,f.fullView.addChild(w.steel_fender);for(var i=0;i<=15;i++)w.steel_fender=new p["Sprite"](e.textures["grass_fender_1.png"]),w.steel_fender.y=37,w.steel_fender.x=w.steel_fender.width*i+100*i,f.fullView.addChild(w.steel_fender);for(var n=230,s=0;s<5;s++)0===s||4===s?(w.seat_stair=new p["Sprite"](e.textures["seat_stair.png"]),w.seat_stair.x=n,w.seat_stair.y=-12,f.fullView.addChild(w.seat_stair),n+=w.seat_stair.width):(w.seat=new p["Sprite"](e.textures["seat.png"]),w.seat_exit=new p["Sprite"](e.textures["seat_exit.png"]),w.seat.x=n,f.fullView.addChild(w.seat),n+=w.seat.width,w.seat_exit.x=n,f.fullView.addChild(w.seat_exit),n+=w.seat_exit.width);n+=150;for(var l=0;l<5;l++)0===l||4===l?(w.seat_stair=new p["Sprite"](e.textures["seat_stair.png"]),w.seat_stair.x=n,f.fullView.addChild(w.seat_stair),n+=w.seat_stair.width):(w.seat=new p["Sprite"](e.textures["seat.png"]),w.seat_exit=new p["Sprite"](e.textures["seat_exit.png"]),w.seat.x=n,f.fullView.addChild(w.seat),n+=w.seat.width,w.seat_exit.x=n,f.fullView.addChild(w.seat_exit),n+=w.seat_exit.width);n+=150;for(var c=0;c<5;c++)0===c||4===c?(w.seat_stair=new p["Sprite"](e.textures["seat_stair.png"]),w.seat_stair.x=n,f.fullView.addChild(w.seat_stair),n+=w.seat_stair.width):(w.seat=new p["Sprite"](e.textures["seat.png"]),w.seat_exit=new p["Sprite"](e.textures["seat_exit.png"]),w.seat.x=n,f.fullView.addChild(w.seat),n+=w.seat.width,w.seat_exit.x=n,f.fullView.addChild(w.seat_exit),n+=w.seat_exit.width);for(var d=0;d<5;d++)for(var u=1;u<=10;u++)w.audiences.push(new p["extras"].AnimatedSprite(e.animations["audience".concat(u)]));for(var m=0;m<w.audiences.length;m++)w.audiences[m].y=55+g(0,100)/100*10,w.audiences[m].x=200+g(0,100)/100*2100,w.audiences[m].animationSpeed=.1,w.audiences[m].play(),f.fullView.addChild(w.audiences[m]);for(var _=0;_<10;_++)w.track=new p["Sprite"](e.textures["track.png"]),w.track.y=50,w.track.x=w.track.width*_-_,f.fullView.addChild(w.track);w.road_decoration=new p["Sprite"](e.textures["road_decoration.png"]),w.road_decoration.x=125,w.road_decoration.y=40,f.fullView.addChild(w.road_decoration);for(var v=0;v<11;v++)for(var y=0;y<=40;y++)w.track_floor=new p["Sprite"](e.textures["track_floor.png"]),w.track_floor.x=w.track_floor.width*y-v%2*30,w.track_floor.y=174+15*v-v,f.fullView.addChild(w.track_floor);for(var k=0;k<22;k++)for(var b=0;b<=40;b++)w.track_floor=new p["Sprite"](e.textures["track_floor.png"]),w.track_floor.x=w.track_floor.width*b-k%2*30-8*k,w.track_floor.y=174+15*k-k-8*k,f.fullView.addChild(w.track_floor);for(var S=25,x=8,T=20,C=120,H=1;H<=8;H++)w.horses.push(new p["extras"].AnimatedSprite(e.animations["horse".concat(H)]));for(var j=0;j<w.horses.length;j++)w.horses[j].vx=0,w.horses[j].animationSpeed=.1,w.horses[j].play(),w.horses[j].x=T+x*w.horses.length-x*(j-1),w.horses[j].y=C+S*(j-1);for(var I=1;I<=8;I++)w.waitingHorses.push(new p["Sprite"](e.textures["horse".concat(I,"_01.png")]));for(var U=0;U<w.waitingHorses.length;U++)w.waitingHorses[U].vx=0,w.waitingHorses[U].x=T+x*w.waitingHorses.length-x*(U-1),w.waitingHorses[U].y=C+S*(U-1),f.fullView.addChild(w.waitingHorses[U]);for(var z=0;z<10;z++)w.track=new p["Sprite"](e.textures["track.png"]),w.track.y=280,w.track.x=w.track.width*z-z,f.fullView.addChild(w.track);w.sign=new p["Sprite"](e.textures["sign.png"]),w.road_decoration=new p["Sprite"](e.textures["road_decoration.png"]),w.sign.y=280,w.sign.x=2200,f.fullView.addChild(w.sign),w.road_decoration.y=260,w.road_decoration.x=2240,f.fullView.addChild(w.road_decoration),h.stage.addChild(f.fullView),h.ticker.add(function(e){return t.gameLoop(e)})}},mounted:function(){h=new p["Application"]({width:window.innerWidth,height:365,antialias:!1,transparent:!1,resolution:1}),document.getElementById("game_body").appendChild(h.view),p["loader"].add("images/fastma_spritesheet.json").load(this.gameLoadSetup),this.loaderEngine=setInterval(this.loader,this.engineIntv)}},v=_,y=o("2877"),k=Object(y["a"])(v,n,s,!1,null,"360953d8",null),b=k.exports,S=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-card",{staticStyle:{"margin-top":"10px"}},[o("el-input",{staticStyle:{"margin-top":"10px"},attrs:{autocapitalize:"off",autocorrect:"off",placeholder:"下注金额（整数）",type:"number"},model:{value:t.stake_token,callback:function(e){t.stake_token=e},expression:"stake_token"}}),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:16}},[o("el-select",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"请选择赛道"},model:{value:t.selectedTrack,callback:function(e){t.selectedTrack=e},expression:"selectedTrack"}},t._l(t.tracks,function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),o("el-col",{attrs:{span:8}},[o("el-button",{staticStyle:{"margin-top":"10px",width:"100%"},attrs:{type:"primary"},on:{click:t.doBet}},[t._v("投注")])],1)],1),o("el-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:t.betHistoryData,height:"150"}},[o("el-table-column",{attrs:{prop:"stake_token",label:"下注金额","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{prop:"racetrack_id",label:"赛道"}}),o("el-table-column",{attrs:{prop:"userid",label:"用户ID"}}),o("el-table-column",{attrs:{prop:"time",label:"时间","show-overflow-tooltip":""}})],1)],1)},x=[],T={name:"BettingOption",props:{jwtToken:String},mounted:function(){var t=this;this.loadAllBetHistory(),setInterval(function(){t.loadAllBetHistory()},5e3)},methods:{doBet:function(){var t=this;null!==this.selectedTrack&&null!==this.stake_token&&u.a.post(this.gameServer+"/order",{stake_token:this.stake_token,racetrack_id:this.selectedTrack},{headers:{Authorization:this.jwtToken}}).then(function(e){e.data.status?(t.stake_token=null,t.selectedTrack=null,t.$notify({title:"投注成功",type:"success",position:"bottom-right"}),t.eventBus.$emit("updateUserInfo")):t.$notify({title:e.data.content,type:"error",position:"bottom-right"})})},loadAllBetHistory:function(){var t=this;u.a.get(this.gameServer+"/allorder",{headers:{Authorization:this.jwtToken}}).then(function(e){var o=e.data;t.betHistoryData=[];for(var a=0;a<o.length;a++)t.betHistoryData.push({stake_token:o[a].stake_token,racetrack_id:o[a].racetrack_id,time:o[a].time,userid:o[a].userid})})}},data:function(){return{betHistoryData:[],stake_token:null,selectedTrack:null,tracks:[{value:0,label:"1"},{value:1,label:"2"},{value:2,label:"3"},{value:3,label:"4"},{value:4,label:"5"},{value:5,label:"6"},{value:6,label:"7"},{value:7,label:"8"}]}}},C=T,H=Object(y["a"])(C,S,x,!1,null,"41b60136",null),j=H.exports,I=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[t.card_shown?t._e():o("el-card",{staticClass:"form-card"},[o("div",{staticStyle:{"text-align":"center"}},[o("span",{staticStyle:{"font-size":"24px"}},[t._v("请登录")]),o("div",{staticStyle:{"margin-top":"10px"}},[o("label",{staticStyle:{width:"30%"}},[t._v("账户名：")]),o("el-input",{staticStyle:{width:"70%"},attrs:{autocapitalize:"off",autocorrect:"off"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}})],1),o("div",{staticStyle:{"margin-top":"10px"}},[o("label",{staticStyle:{width:"30%"}},[t._v("    密码：")]),o("el-input",{staticStyle:{width:"70%"},attrs:{autocapitalize:"off",autocorrect:"off","show-password":""},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),o("div",[o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},attrs:{type:"primary"},on:{click:t.doLogin}},[t._v("登录")]),o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},on:{click:t.switchCard}},[t._v("还没有账户，注册")])],1)])]),t.card_shown?o("el-card",{staticClass:"form-card"},[o("div",{staticStyle:{"text-align":"center"}},[o("span",{staticStyle:{"font-size":"24px"}},[t._v("请注册")]),o("div",{staticStyle:{"margin-top":"10px"}},[o("label",{staticStyle:{width:"30%"}},[t._v("账户名：")]),o("el-input",{staticStyle:{width:"70%"},attrs:{autocapitalize:"off",autocorrect:"off"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}})],1),o("div",{staticStyle:{"margin-top":"10px"}},[o("label",{staticStyle:{width:"30%"}},[t._v("    密码：")]),o("el-input",{staticStyle:{width:"70%"},attrs:{autocapitalize:"off",autocorrect:"off","show-password":""},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),o("div",{staticStyle:{"margin-top":"10px"}},[o("label",{staticStyle:{width:"30%"}},[t._v("确认密码：")]),o("el-input",{staticStyle:{width:"70%"},attrs:{autocapitalize:"off",autocorrect:"off","show-password":""},model:{value:t.confirm_password,callback:function(e){t.confirm_password=e},expression:"confirm_password"}}),t._v("   ")],1),o("div",[o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},attrs:{type:"primary"},on:{click:t.doRegister}},[t._v("注册")]),o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},on:{click:t.switchCard}},[t._v("已有账号，登录")])],1)])]):t._e()],1)},U=[],z={data:function(){return{card_shown:0,username:null,password:null,confirm_password:null}},methods:{switchCard:function(){this.card_shown?this.card_shown=0:this.card_shown=1},doRegister:function(){var t=this;null===this.username||null===this.password||null===this.confirm_password?this.$notify({title:"未填写账户名/密码",type:"error",position:"bottom-right"}):this.password!==this.confirm_password?this.$notify({title:"两次输入的密码不一致",type:"error",position:"bottom-right"}):u.a.post(this.userServer+"/register",{username:this.username,password:this.password}).then(function(e){0===e.data.code?(t.$notify({title:"注册成功",type:"success",position:"bottom-right",duration:2e3}),t.card_shown=0):t.$notify({title:e.data.content,type:"error",position:"bottom-right"})})},doLogin:function(){var t=this;null===this.username||null===this.password?this.$notify({title:"未填写账户名/密码",type:"error",position:"bottom-right"}):u.a.post(this.userServer+"/login",{username:this.username,password:this.password}).then(function(e){0===e.data.code?t.$emit("loginSuccess",e.data.token):t.$notify({title:e.data.content,type:"error"})})}},name:"LoginComponent"},V=z,W=(o("16e2"),Object(y["a"])(V,I,U,!1,null,"66031adb",null)),$=W.exports,B=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-card",[o("div",{staticClass:"info-text"},[o("span",[t._v("用户名："+t._s(t.username))]),o("span",{staticStyle:{float:"right"}},[t._v("余额："+t._s(t.balance))]),o("div",{directives:[{name:"show",rawName:"v-show",value:!t.showTopUp&&!t.showTopUpHistory&&!t.showWithdraw&&!t.showWithdrawHistory,expression:"!showTopUp && !showTopUpHistory && !showWithdraw && !showWithdrawHistory"}]},[o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},attrs:{type:"primary"},on:{click:t.toggleTopUp}},[t._v("充值")]),o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},on:{click:t.toggleTopUpHistory}},[t._v("充值历史")]),o("br"),o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},on:{click:t.toggleWithdraw}},[t._v("提现")]),o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},on:{click:t.toggleWithdrawHistory}},[t._v("提现历史")])],1),o("div",{directives:[{name:"show",rawName:"v-show",value:t.showTopUp,expression:"showTopUp"}]},[o("el-input",{staticStyle:{"margin-top":"10px"},attrs:{autocapitalize:"off",autocorrect:"off",placeholder:"Token数（100的倍数）",type:"number"},model:{value:t.order_size,callback:function(e){t.order_size=e},expression:"order_size"}}),o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},attrs:{type:"primary"},on:{click:t.goTopUp}},[t._v("去购买")]),o("el-button",{staticStyle:{"font-family":"'Noto Serif SC', serif"},on:{click:t.toggleTopUp}},[t._v("取消")])],1),o("div",{directives:[{name:"show",rawName:"v-show",value:t.showTopUpHistory,expression:"showTopUpHistory"}]},[o("el-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:t.topUpHistoryData,height:"150"}},[o("el-table-column",{attrs:{prop:"cb_id",label:"充值ID"}}),o("el-table-column",{attrs:{prop:"order_size",label:"充值数"}}),o("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{disabled:0!==e.row.status,size:"medium",type:0===e.row.status?"primary":"default"},on:{click:function(o){return t.goCoinbasePage(e.row.cb_id)}}},[t._v("\n                            "+t._s(0===e.row.status?"去转账":"已完成")+"\n                        ")])]}}])})],1),o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},on:{click:t.toggleTopUpHistory}},[t._v("返回")])],1),o("div",{directives:[{name:"show",rawName:"v-show",value:t.showWithdraw,expression:"showWithdraw"}]},[o("el-input",{staticStyle:{"margin-top":"10px"},attrs:{autocapitalize:"off",autocorrect:"off",placeholder:"EOS 账户名"},model:{value:t.eos_account,callback:function(e){t.eos_account=e},expression:"eos_account"}}),o("el-input",{staticStyle:{"margin-top":"10px"},attrs:{autocapitalize:"off",autocorrect:"off",placeholder:"Memo (提现到交易所必须填写充值Memo)"},model:{value:t.eos_memo,callback:function(e){t.eos_memo=e},expression:"eos_memo"}}),o("el-input",{staticStyle:{"margin-top":"10px"},attrs:{autocapitalize:"off",autocorrect:"off",placeholder:"提现的 Token 数（100的倍数）",type:"number"},model:{value:t.withdraw_amount,callback:function(e){t.withdraw_amount=e},expression:"withdraw_amount"}}),o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},attrs:{type:"primary"},on:{click:t.goWithdraw}},[t._v("提现")]),o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},on:{click:t.toggleWithdraw}},[t._v("返回")])],1),o("div",{directives:[{name:"show",rawName:"v-show",value:t.showWithdrawHistory,expression:"showWithdrawHistory"}]},[o("el-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:t.withdrawHistoryData,height:"150"}},[o("el-table-column",{attrs:{prop:"amount_eos",label:"EOS","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{prop:"amount_token",label:"Token"}}),o("el-table-column",{attrs:{prop:"eos_account",label:"EOS账户","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{prop:"eos_memo",label:"Memo"}}),o("el-table-column",{attrs:{prop:"if_done",label:"状态"}}),o("el-table-column",{attrs:{prop:"txid",label:"txid","show-overflow-tooltip":""}})],1),o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},on:{click:t.toggleWithdrawHistory}},[t._v("返回")])],1)])])},N=[],O={name:"UserInfo",props:{jwtToken:String},data:function(){return{showWithdrawHistory:!1,eos_account:null,eos_memo:null,withdraw_amount:null,balance:null,username:null,showTopUp:!1,order_size:null,showTopUpHistory:!1,topUpHistoryData:[],showWithdraw:!1,withdrawHistoryData:[]}},mounted:function(){var t=this;this.eventBus.$on("updateUserInfo",function(){t.getUserInfo()})},methods:{toggleWithdrawHistory:function(){var t=this;this.showWithdrawHistory=!this.showWithdrawHistory,u.a.get(this.fundServer+"/withdraw",{headers:{Authorization:this.jwtToken}}).then(function(e){if(e.data.status){var o=e.data.result;t.withdrawHistoryData=[];for(var a=0;a<o.length;a++)t.withdrawHistoryData.push({amount_eos:o[a].amount_eos,amount_token:o[a].amount_token,eos_account:o[a].eos_account,eos_memo:o[a].eos_memo,if_done:0===c()(o[a].if_done)?"等待处理":"已转账",txid:o[a].txid})}else t.$notify({title:"Server Error...",type:"error",position:"bottom-right"})})},goWithdraw:function(){var t=this;null!==this.withdraw_amount&&this.withdraw_amount%100===0&&0!==this.withdraw_amount&&null!==this.eos_account?u.a.post(this.fundServer+"/withdraw",{eos_memo:this.eos_memo?this.eos_memo:" ",eos_account:this.eos_account,amount_token:this.withdraw_amount},{headers:{Authorization:this.jwtToken}}).then(function(e){e.data.status?(t.eos_account=null,t.eos_memo=null,t.withdraw_amount=null,t.$notify({title:"提现成功，请等待程序自动结算",type:"success",position:"bottom-right"}),t.getUserInfo(),t.showWithdraw=!1):t.$notify({title:e.data.result,type:"error",position:"bottom-right"})}):this.$notify({title:"Token数量填写错误",type:"error",position:"bottom-right"})},toggleWithdraw:function(){this.showWithdraw=!this.showWithdraw},toggleTopUpHistory:function(){var t=this;this.showTopUpHistory=!this.showTopUpHistory,u.a.get(this.fundServer+"/topup",{headers:{Authorization:this.jwtToken}}).then(function(e){if(e.data.status){var o=e.data.result;t.topUpHistoryData=[];for(var a=0;a<o.length;a++)t.topUpHistoryData.push({cb_id:o[a].cb_id,order_size:o[a].order_size,status:c()(o[a].if_done)})}else t.$notify({title:"Server Error...",type:"error",position:"bottom-right"})})},toggleTopUp:function(){this.showTopUp=!this.showTopUp},goCoinbasePage:function(t){window.open("https://commerce.coinbase.com/charges/"+t)},goTopUp:function(){var t=this;null!==this.order_size&&this.order_size%100===0&&0!==this.order_size?u.a.post(this.fundServer+"/topup",{order_size:this.order_size},{headers:{Authorization:this.jwtToken}}).then(function(e){e.data.status?(t.toggleTopUp(),t.toggleTopUpHistory()):t.$notify({title:"Server Error...",type:"error",position:"bottom-right"})}):this.$notify({title:"Token数量填写错误",type:"error",position:"bottom-right"})},getUserInfo:function(){var t=this;u.a.get(this.userServer+"/userInfo",{headers:{Authorization:this.jwtToken}}).then(function(e){t.balance=e.data.balance,t.username=e.data.username})}},created:function(){this.getUserInfo()}},E=O,A=(o("8c08"),Object(y["a"])(E,B,N,!1,null,"1c0ca920",null)),D=A.exports,G=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-card",[o("div",{attrs:{slot:"header"},slot:"header"},[t._v("\n        游戏状态信息\n    ")]),o("el-card",[o("div",{attrs:{slot:"header"},slot:"header"},[t._v("赛马信息:")]),o("el-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:t.racetracks,height:"150"}},[o("el-table-column",{attrs:{prop:"total_token",label:"总下注量","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{prop:"distance",label:"跑出距离","show-overflow-tooltip":""}})],1)],1),o("el-card",{staticStyle:{"margin-top":"10px"}},[o("div",{attrs:{slot:"header"},slot:"header"},[t._v("选用的BlockID:")]),o("el-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:t.block_ids,height:"150"}},[o("el-table-column",{attrs:{prop:"blockid",label:"BlockID","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{prop:"time",label:"Time","show-overflow-tooltip":""}})],1)],1),o("el-card",{staticStyle:{"margin-top":"10px"}},[o("div",{attrs:{slot:"header"},slot:"header"},[t._v("游戏状态:")]),o("div",[o("div",[t._v("开始状态："+t._s(t.game_status.isGaming?"比赛开始":"比赛未开始"))]),o("div",[t._v("下注状态："+t._s(t.game_status.isBetting?"可以下注":"下注停止"))]),o("div",[t._v("结算状态："+t._s(t.game_status.isGaming||t.game_status.isBetting?"未在结算":"结算冷却"))])])])],1)},L=[],M={name:"GameInfo",props:{jwtToken:String},mounted:function(){var t=this;this.loadInfo(),this.loadBlockId(),setInterval(function(){t.loadInfo(),t.loadBlockId()},1e4)},methods:{loadInfo:function(){var t=this;u.a.get(this.gameServer+"/racetracks",{headers:{Authorization:this.jwtToken}}).then(function(e){var o=JSON.parse(e.data);t.game_status.isGaming=c()(o.isGaming),t.game_status.isBetting=c()(o.isBetting);for(var a=0;a<o.racetracks.length;a++)t.racetracks.push({total_token:o.racetracks[a].total_token,distance:o.distances[a]})})},loadBlockId:function(){var t=this;u.a.get(this.gameServer+"/blockid_backup",{headers:{Authorization:this.jwtToken}}).then(function(e){t.block_ids=e.data})}},data:function(){return{block_ids:[],game_status:{},racetracks:[]}}},P=M,J=Object(y["a"])(P,G,L,!1,null,"fe2b1124",null),R=J.exports,q={name:"app",components:{GameStage:b,Betting:j,LoginComponent:$,UserInfo:D,GameInfo:R},data:function(){return{jwtToken:null}},methods:{handleLogin:function(t){this.jwtToken=t}}},F=q,K=(o("034f"),Object(y["a"])(F,r,i,!1,null,null,null)),Q=K.exports,X=o("5c96"),Y=o.n(X),Z=(o("0fae"),o("b2d6")),tt=o.n(Z);a["default"].use(Y.a,{locale:tt.a}),a["default"].config.productionTip=!1;var et="http://45.32.135.124";a["default"].prototype.userServer=et+":8801",a["default"].prototype.fundServer=et+":8802",a["default"].prototype.gameServer=et+":8803",a["default"].prototype.eventBus=new a["default"],new a["default"]({render:function(t){return t(Q)}}).$mount("#app")},"64a9":function(t,e,o){},"8c08":function(t,e,o){"use strict";var a=o("f8bd"),r=o.n(a);r.a},ae3f:function(t,e,o){},f8bd:function(t,e,o){}});
//# sourceMappingURL=app.2a812c03.js.map
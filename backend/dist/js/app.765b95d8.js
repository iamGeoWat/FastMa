(function(t){function e(e){for(var r,n,s=e[0],l=e[1],d=e[2],c=0,p=[];c<s.length;c++)n=s[c],i[n]&&p.push(i[n][0]),i[n]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(t[r]=l[r]);u&&u(e);while(p.length)p.shift()();return a.push.apply(a,d||[]),o()}function o(){for(var t,e=0;e<a.length;e++){for(var o=a[e],r=!0,s=1;s<o.length;s++){var l=o[s];0!==i[l]&&(r=!1)}r&&(a.splice(e--,1),t=n(n.s=o[0]))}return t}var r={},i={app:0},a=[];function n(e){if(r[e])return r[e].exports;var o=r[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=r,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var d=0;d<s.length;d++)e(s[d]);var u=l;a.push([0,"chunk-vendors"]),o()})({0:function(t,e,o){t.exports=o("56d7")},"034f":function(t,e,o){"use strict";var r=o("64a9"),i=o.n(r);i.a},"040b":function(t,e,o){"use strict";var r=o("21fc"),i=o.n(r);i.a},"21fc":function(t,e,o){},"56d7":function(t,e,o){"use strict";o.r(e);o("cadf"),o("551c"),o("f751"),o("097d");var r=o("2b0e"),i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"app"}},[null===t.jwtToken?o("div",[o("LoginComponent",{on:{loginSuccess:t.handleLogin}})],1):o("div",[o("GameStage"),null!==t.jwtToken?o("UserInfo",{attrs:{"jwt-token":t.jwtToken}}):t._e(),o("BettingOption")],1)])},a=[],n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("el-button",{on:{click:t.runStart}},[t._v("Start")]),o("div",{attrs:{id:"game_body"}})],1)},s=[],l=(o("55dd"),o("912c")),d=null,u={fullView:null},c={horses:[],track:null,concrete:null,steel_fender:null,grass_fender:null,seat:null,seat_exit:null,seat_stair:null,road_decoration:null,track_floor:null,sign:null,audiences:[]},p=function(){};function h(t,e){return Math.floor(Math.random()*(e-t+1))+t}var f={name:"GameStage",methods:{runStart:function(){p=this.horseRunRandomlyState},cameraScroll:function(){for(var t=[],e=0;e<c.horses.length;e++)t.push(c.horses[e].x);t.sort(function(t,e){return e-t});var o=t[0];o>=window.innerWidth-150-u.fullView.x&&(u.fullView.x-=o-(window.innerWidth-150-u.fullView.x))},horseRunRandomlyState:function(){for(var t=0;t<c.horses.length;t++){var e=h(1,2),o=h(1,2)/10;1===e?(c.horses[t].vx+=o,c.horses[t].x+=c.horses[t].vx):c.horses[t].vx-o>=0&&(c.horses[t].vx-=o,c.horses[t].x+=c.horses[t].vx)}this.cameraScroll(),u.fullView.x<=-2350+window.innerWidth&&(p=this.pauseState)},pauseState:function(){},gameLoop:function(t){p(t)},gameLoadSetup:function(){var t=this,e=l["loader"].resources["images/fastma_spritesheet.json"].spritesheet;u.fullView=new l["Container"];for(var o=0;o<8;o++)for(var r=0;r<=40;r++)c.concrete=new l["Sprite"](e.textures["concrete.png"]),c.concrete.x=c.concrete.width*r-o%2*30,c.concrete.y=15*o-15-o,u.fullView.addChild(c.concrete);for(var i=0;i<=20;i++)c.steel_fender=new l["Sprite"](e.textures["steel_fender_1.png"]),c.steel_fender.y=30,c.steel_fender.x=c.steel_fender.width*i,u.fullView.addChild(c.steel_fender);for(var a=0;a<=15;a++)c.steel_fender=new l["Sprite"](e.textures["grass_fender_1.png"]),c.steel_fender.y=37,c.steel_fender.x=c.steel_fender.width*a+100*a,u.fullView.addChild(c.steel_fender);for(var n=230,s=0;s<5;s++)0===s||4===s?(c.seat_stair=new l["Sprite"](e.textures["seat_stair.png"]),c.seat_stair.x=n,c.seat_stair.y=-12,u.fullView.addChild(c.seat_stair),n+=c.seat_stair.width):(c.seat=new l["Sprite"](e.textures["seat.png"]),c.seat_exit=new l["Sprite"](e.textures["seat_exit.png"]),c.seat.x=n,u.fullView.addChild(c.seat),n+=c.seat.width,c.seat_exit.x=n,u.fullView.addChild(c.seat_exit),n+=c.seat_exit.width);n+=150;for(var p=0;p<5;p++)0===p||4===p?(c.seat_stair=new l["Sprite"](e.textures["seat_stair.png"]),c.seat_stair.x=n,u.fullView.addChild(c.seat_stair),n+=c.seat_stair.width):(c.seat=new l["Sprite"](e.textures["seat.png"]),c.seat_exit=new l["Sprite"](e.textures["seat_exit.png"]),c.seat.x=n,u.fullView.addChild(c.seat),n+=c.seat.width,c.seat_exit.x=n,u.fullView.addChild(c.seat_exit),n+=c.seat_exit.width);n+=150;for(var f=0;f<5;f++)0===f||4===f?(c.seat_stair=new l["Sprite"](e.textures["seat_stair.png"]),c.seat_stair.x=n,u.fullView.addChild(c.seat_stair),n+=c.seat_stair.width):(c.seat=new l["Sprite"](e.textures["seat.png"]),c.seat_exit=new l["Sprite"](e.textures["seat_exit.png"]),c.seat.x=n,u.fullView.addChild(c.seat),n+=c.seat.width,c.seat_exit.x=n,u.fullView.addChild(c.seat_exit),n+=c.seat_exit.width);for(var w=0;w<5;w++)for(var m=1;m<=10;m++)c.audiences.push(new l["extras"].AnimatedSprite(e.animations["audience".concat(m)]));for(var _=0;_<c.audiences.length;_++)c.audiences[_].y=55+h(0,100)/100*10,c.audiences[_].x=200+h(0,100)/100*2100,c.audiences[_].animationSpeed=.1,c.audiences[_].play(),u.fullView.addChild(c.audiences[_]);for(var g=0;g<10;g++)c.track=new l["Sprite"](e.textures["track.png"]),c.track.y=50,c.track.x=c.track.width*g-g,u.fullView.addChild(c.track);c.road_decoration=new l["Sprite"](e.textures["road_decoration.png"]),c.road_decoration.x=125,c.road_decoration.y=40,u.fullView.addChild(c.road_decoration);for(var y=0;y<11;y++)for(var v=0;v<=40;v++)c.track_floor=new l["Sprite"](e.textures["track_floor.png"]),c.track_floor.x=c.track_floor.width*v-y%2*30,c.track_floor.y=174+15*y-y,u.fullView.addChild(c.track_floor);for(var x=0;x<22;x++)for(var S=0;S<=40;S++)c.track_floor=new l["Sprite"](e.textures["track_floor.png"]),c.track_floor.x=c.track_floor.width*S-x%2*30-8*x,c.track_floor.y=174+15*x-x-8*x,u.fullView.addChild(c.track_floor);for(var b=25,k=8,C=20,T=120,U=1;U<=8;U++)c.horses.push(new l["extras"].AnimatedSprite(e.animations["horse".concat(U)]));for(var H=0;H<c.horses.length;H++)c.horses[H].vx=0,c.horses[H].animationSpeed=.1,c.horses[H].play(),c.horses[H].x=C+k*c.horses.length-k*(H-1),c.horses[H].y=T+b*(H-1),u.fullView.addChild(c.horses[H]);for(var V=0;V<10;V++)c.track=new l["Sprite"](e.textures["track.png"]),c.track.y=280,c.track.x=c.track.width*V-V,u.fullView.addChild(c.track);c.sign=new l["Sprite"](e.textures["sign.png"]),c.road_decoration=new l["Sprite"](e.textures["road_decoration.png"]),c.sign.y=280,c.sign.x=2200,u.fullView.addChild(c.sign),c.road_decoration.y=260,c.road_decoration.x=2240,u.fullView.addChild(c.road_decoration),d.stage.addChild(u.fullView),d.ticker.add(function(e){return t.gameLoop(e)})}},mounted:function(){d=new l["Application"]({width:window.innerWidth,height:365,antialias:!1,transparent:!1,resolution:1}),document.getElementById("game_body").appendChild(d.view),l["loader"].add("images/fastma_spritesheet.json").load(this.gameLoadSetup)}},w=f,m=o("2877"),_=Object(m["a"])(w,n,s,!1,null,"cfbdf89e",null),g=_.exports,y=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div")},v=[],x={name:"BettingOption"},S=x,b=Object(m["a"])(S,y,v,!1,null,"27e834f1",null),k=b.exports,C=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[t.card_shown?t._e():o("el-card",{staticClass:"form-card"},[o("div",{staticStyle:{"text-align":"center"}},[o("span",{staticStyle:{"font-size":"24px"}},[t._v("请登录")]),o("div",{staticStyle:{"margin-top":"10px"}},[o("label",{staticStyle:{width:"30%"}},[t._v("账户名：")]),o("el-input",{staticStyle:{width:"70%"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}})],1),o("div",{staticStyle:{"margin-top":"10px"}},[o("label",{staticStyle:{width:"30%"}},[t._v("    密码：")]),o("el-input",{staticStyle:{width:"70%"},attrs:{"show-password":""},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),o("div",[o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},attrs:{type:"primary"},on:{click:t.doLogin}},[t._v("登录")]),o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},on:{click:t.switchCard}},[t._v("还没有账户，注册")])],1)])]),t.card_shown?o("el-card",{staticClass:"form-card"},[o("div",{staticStyle:{"text-align":"center"}},[o("span",{staticStyle:{"font-size":"24px"}},[t._v("请注册")]),o("div",{staticStyle:{"margin-top":"10px"}},[o("label",{staticStyle:{width:"30%"}},[t._v("账户名：")]),o("el-input",{staticStyle:{width:"70%"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}})],1),o("div",{staticStyle:{"margin-top":"10px"}},[o("label",{staticStyle:{width:"30%"}},[t._v("    密码：")]),o("el-input",{staticStyle:{width:"70%"},attrs:{"show-password":""},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),o("div",{staticStyle:{"margin-top":"10px"}},[o("label",{staticStyle:{width:"30%"}},[t._v("确认密码：")]),o("el-input",{staticStyle:{width:"70%"},attrs:{"show-password":""},model:{value:t.confirm_password,callback:function(e){t.confirm_password=e},expression:"confirm_password"}}),t._v("   ")],1),o("div",[o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},attrs:{type:"primary"},on:{click:t.doRegister}},[t._v("注册")]),o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},on:{click:t.switchCard}},[t._v("已有账号，登录")])],1)])]):t._e()],1)},T=[],U=o("bc3a"),H=o.n(U),V={data:function(){return{card_shown:0,username:null,password:null,confirm_password:null}},methods:{switchCard:function(){this.card_shown?this.card_shown=0:this.card_shown=1},doRegister:function(){var t=this;null===this.username||null===this.password||null===this.confirm_password?this.$notify({title:"未填写账户名/密码",type:"error",position:"bottom-right"}):this.password!==this.confirm_password?this.$notify({title:"两次输入的密码不一致",type:"error",position:"bottom-right"}):H.a.post(this.userServer+"/register",{username:this.username,password:this.password}).then(function(e){0===e.data.code?(t.$notify({title:"注册成功",type:"success",position:"bottom-right",duration:2e3}),t.card_shown=0):t.$notify({title:e.data.content,type:"error",position:"bottom-right"})})},doLogin:function(){var t=this;null===this.username||null===this.password?this.$notify({title:"未填写账户名/密码",type:"error",position:"bottom-right"}):H.a.post(this.userServer+"/login",{username:this.username,password:this.password}).then(function(e){0===e.data.code?t.$emit("loginSuccess",e.data.token):t.$notify({title:e.data.content,type:"error"})})}},name:"LoginComponent"},j=V,W=(o("7df3"),Object(m["a"])(j,C,T,!1,null,"150be309",null)),z=W.exports,O=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-card",[o("div",{staticClass:"info-text"},[o("span",[t._v("用户名："+t._s(t.username))]),o("span",{staticStyle:{float:"right"}},[t._v("余额："+t._s(t.balance))]),o("div",{directives:[{name:"show",rawName:"v-show",value:!t.showTopUp&&!t.showTopUpHistory&&!t.showWithdraw&&!t.showWithdrawHistory,expression:"!showTopUp && !showTopUpHistory && !showWithdraw && !showWithdrawHistory"}]},[o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},attrs:{type:"primary"},on:{click:t.toggleTopUp}},[t._v("充值")]),o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},on:{click:t.toggleTopUpHistory}},[t._v("充值历史")]),o("br"),o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},on:{click:t.toggleWithdraw}},[t._v("提现")]),o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},on:{click:t.toggleWithdrawHistory}},[t._v("提现历史")])],1),o("div",{directives:[{name:"show",rawName:"v-show",value:t.showTopUp,expression:"showTopUp"}]},[o("el-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"Token数（100的倍数）",type:"number"},model:{value:t.order_size,callback:function(e){t.order_size=e},expression:"order_size"}}),o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},attrs:{type:"primary"},on:{click:t.goTopUp}},[t._v("去购买")]),o("el-button",{staticStyle:{"font-family":"'Noto Serif SC', serif"},on:{click:t.toggleTopUp}},[t._v("取消")])],1),o("div",{directives:[{name:"show",rawName:"v-show",value:t.showTopUpHistory,expression:"showTopUpHistory"}]},[o("el-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:t.topUpHistoryData,height:"150"}},[o("el-table-column",{attrs:{prop:"cb_id",label:"充值ID"}}),o("el-table-column",{attrs:{prop:"order_size",label:"充值数"}}),o("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{disabled:0!==e.row.status,size:"medium",type:0===e.row.status?"primary":"default"},on:{click:function(o){return t.goCoinbasePage(e.row.cb_id)}}},[t._v("\n                            "+t._s(0===e.row.status?"去转账":"已完成")+"\n                        ")])]}}])})],1),o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},on:{click:t.toggleTopUpHistory}},[t._v("返回")])],1),o("div",{directives:[{name:"show",rawName:"v-show",value:t.showWithdraw,expression:"showWithdraw"}]},[o("el-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"EOS 账户名"},model:{value:t.eos_account,callback:function(e){t.eos_account=e},expression:"eos_account"}}),o("el-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"Memo (提现到交易所必须填写充值Memo)"},model:{value:t.eos_memo,callback:function(e){t.eos_memo=e},expression:"eos_memo"}}),o("el-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"提现的 Token 数（100的倍数）",type:"number"},model:{value:t.withdraw_amount,callback:function(e){t.withdraw_amount=e},expression:"withdraw_amount"}}),o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},attrs:{type:"primary"},on:{click:t.goWithdraw}},[t._v("提现")]),o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},on:{click:t.toggleWithdraw}},[t._v("返回")])],1),o("div",{directives:[{name:"show",rawName:"v-show",value:t.showWithdrawHistory,expression:"showWithdrawHistory"}]},[o("el-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:t.withdrawHistoryData,height:"150"}},[o("el-table-column",{attrs:{prop:"amount_eos",label:"EOS","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{prop:"amount_token",label:"Token"}}),o("el-table-column",{attrs:{prop:"eos_account",label:"EOS账户","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{prop:"eos_memo",label:"Memo"}}),o("el-table-column",{attrs:{prop:"if_done",label:"状态"}}),o("el-table-column",{attrs:{prop:"txid",label:"txid","show-overflow-tooltip":""}})],1),o("el-button",{staticStyle:{"margin-top":"10px","font-family":"'Noto Serif SC', serif"},on:{click:t.toggleWithdrawHistory}},[t._v("返回")])],1)])])},$=[],N=o("e814"),E=o.n(N),L={name:"UserInfo",props:{jwtToken:String},data:function(){return{showWithdrawHistory:!1,eos_account:null,eos_memo:null,withdraw_amount:null,balance:null,username:null,showTopUp:!1,order_size:null,showTopUpHistory:!1,topUpHistoryData:[],showWithdraw:!1,withdrawHistoryData:[]}},methods:{toggleWithdrawHistory:function(){var t=this;this.showWithdrawHistory=!this.showWithdrawHistory,H.a.get(this.fundServer+"/withdraw",{headers:{Authorization:this.jwtToken}}).then(function(e){if(e.data.status){var o=e.data.result;t.withdrawHistoryData=[];for(var r=0;r<o.length;r++)t.withdrawHistoryData.push({amount_eos:o[r].amount_eos,amount_token:o[r].amount_token,eos_account:o[r].eos_account,eos_memo:o[r].eos_memo,if_done:0===E()(o[r].if_done)?"等待处理":"已转账",txid:o[r].txid})}else t.$notify({title:"Server Error...",type:"error",position:"bottom-right"})})},goWithdraw:function(){var t=this;null!==this.withdraw_amount&&this.withdraw_amount%100===0&&0!==this.withdraw_amount&&null!==this.eos_account?H.a.post(this.fundServer+"/withdraw",{eos_memo:this.eos_memo?this.eos_memo:" ",eos_account:this.eos_account,amount_token:this.withdraw_amount},{headers:{Authorization:this.jwtToken}}).then(function(e){e.data.status?(t.eos_account=null,t.eos_memo=null,t.withdraw_amount=null,t.$notify({title:"提现成功，请等待程序自动结算",type:"success",position:"bottom-right"}),t.getUserInfo(),t.showWithdraw=!1):t.$notify({title:e.data.result,type:"error",position:"bottom-right"})}):this.$notify({title:"Token数量填写错误",type:"error",position:"bottom-right"})},toggleWithdraw:function(){this.showWithdraw=!this.showWithdraw},toggleTopUpHistory:function(){var t=this;this.showTopUpHistory=!this.showTopUpHistory,H.a.get(this.fundServer+"/topup",{headers:{Authorization:this.jwtToken}}).then(function(e){if(e.data.status){var o=e.data.result;t.topUpHistoryData=[];for(var r=0;r<o.length;r++)t.topUpHistoryData.push({cb_id:o[r].cb_id,order_size:o[r].order_size,status:E()(o[r].if_done)})}else t.$notify({title:"Server Error...",type:"error",position:"bottom-right"})})},toggleTopUp:function(){this.showTopUp=!this.showTopUp},goCoinbasePage:function(t){window.open("https://commerce.coinbase.com/charges/"+t)},goTopUp:function(){var t=this;null!==this.order_size&&this.order_size%100===0&&0!==this.order_size?H.a.post(this.fundServer+"/topup",{order_size:this.order_size},{headers:{Authorization:this.jwtToken}}).then(function(e){e.data.status?(t.toggleTopUp(),t.toggleTopUpHistory()):t.$notify({title:"Server Error...",type:"error",position:"bottom-right"})}):this.$notify({title:"Token数量填写错误",type:"error",position:"bottom-right"})},getUserInfo:function(){var t=this;H.a.get(this.userServer+"/userInfo",{headers:{Authorization:this.jwtToken}}).then(function(e){t.balance=e.data.balance,t.username=e.data.username})}},created:function(){this.getUserInfo()}},D=L,I=(o("040b"),Object(m["a"])(D,O,$,!1,null,"f57a8526",null)),M=I.exports,A={name:"app",components:{GameStage:g,BettingOption:k,LoginComponent:z,UserInfo:M},data:function(){return{jwtToken:null}},methods:{handleLogin:function(t){this.jwtToken=t}}},P=A,R=(o("034f"),Object(m["a"])(P,i,a,!1,null,null,null)),B=R.exports,G=o("5c96"),J=o.n(G),q=(o("0fae"),o("b2d6")),F=o.n(q);r["default"].use(J.a,{locale:F.a}),r["default"].config.productionTip=!1;var K="http://localhost";r["default"].prototype.userServer=K+":8801",r["default"].prototype.fundServer=K+":8802",new r["default"]({render:function(t){return t(B)}}).$mount("#app")},"64a9":function(t,e,o){},"7df3":function(t,e,o){"use strict";var r=o("8977"),i=o.n(r);i.a},8977:function(t,e,o){}});
//# sourceMappingURL=app.765b95d8.js.map